"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[689],{6669:(r,e,t)=>{t.d(e,{FI:()=>m,G7:()=>l,GD:()=>f,LM:()=>i,R7:()=>s,Rf:()=>d,_$:()=>a,iZ:()=>u,mt:()=>c});var n=t(9827),o=t(4385);let s=(0,n.v)(r=>({filters:[],addFilter:e=>r(r=>({filters:[...r.filters,e]})),removeFilter:e=>r(r=>({filters:r.filters.filter(r=>r.id!==e)}))})),a=(0,n.v)((r,e)=>({cartItems:[],cartTotal:0,addItem:e=>r(r=>{let t;let n=r.cartItems.findIndex(r=>r.getId()===e.getId());return -1!==n?(t=[...r.cartItems])[n].setQty(e.getQty()):t=[...r.cartItems,e],localStorage.setItem("cartItems",JSON.stringify(t)),{cartItems:t,cartTotal:t.reduce((r,e)=>r+e.getPrice()*e.getQty(),0)}}),removeItem:e=>r(r=>{let t=r.cartItems.find(r=>r.getId()===e);if(!t)return r;let n=r.cartItems.filter(r=>r.getId()!==e),o=t.getPrice()*t.getQty();return localStorage.setItem("cartItems",JSON.stringify(n)),{cartItems:n,cartTotal:r.cartTotal-o}}),getItemCount:()=>e().cartItems.length,cleanCart:()=>r(()=>(localStorage.removeItem("cartItems"),{cartItems:[]}))})),c=(0,n.v)(r=>({cardState:!1,currentItem:null,setCardState:e=>r(()=>({cardState:e})),setCurrentItem:e=>r(()=>({currentItem:e}))})),i=(0,n.v)(r=>({cardViewState:o.G.List,setCardView:e=>r(()=>({cardViewState:e}))})),d=(0,n.v)(r=>({activeState:o.B.History,setActiveState:e=>r(()=>({activeState:e}))})),u=(0,n.v)(r=>({user_data:{documentId:"",first_name:"",last_name:"",company:""},set_current_user:e=>r(()=>({user_data:e}))}));(0,n.v)(r=>({is_logged_in:!1,set_logged_in_status:e=>r(()=>({is_logged_in:e}))}));let l=(0,n.v)((r,e)=>({products:[],categorizedProducts:[],searchQuery:"",loading:!0,selectedCategories:[],setSelectedCategory:t=>{let{selectedCategories:n,categorizedProducts:o}=e();n.includes(t)?r({selectedCategories:n.filter(r=>r!==t),categorizedProducts:o.filter(r=>r.cat!==t),searchQuery:""}):r({selectedCategories:[...n,t],searchQuery:""})},addCategorizedProducts:(e,t)=>{r(r=>({categorizedProducts:[...r.categorizedProducts,{cat:e,cat_prods:t}]}))},setSearchQuery:e=>{let t=e.trim();r(r=>({searchQuery:t,selectedCategories:t.length>0?[]:r.selectedCategories}))},add_product:e=>r(r=>({products:[...r.products,...e],loading:!1}))})),m=(0,n.v)(r=>({isError:!1,setIsError:e=>r({isError:e})})),f=(0,n.v)(r=>({currentHistoryItem:[],setCurrentHistoryItem:e=>r({currentHistoryItem:e})}))},4385:(r,e,t)=>{t.d(e,{B:()=>o,G:()=>n});var n=function(r){return r[r.Product=0]="Product",r[r.List=1]="List",r[r.History=2]="History",r}({}),o=function(r){return r[r.History=0]="History",r[r.Settings=1]="Settings",r}({})},9689:(r,e,t)=>{t.d(e,{lD:()=>N,Oq:()=>b,Sy:()=>O,sR:()=>j,ZR:()=>A,Ol:()=>z,DJ:()=>H,iD:()=>U});var n=t(5991),o=t(3634);let s=new n.R({uri:"http://localhost:1337/graphql",cache:new o.D});var a=t(1716);async function c(r,e,t){try{let{data:n,loading:o,error:a}=await s.query({query:r,fetchPolicy:"no-cache",variables:e||null,context:{headers:t||{}}});if(o)return null;if(a&&console.error("Error fetching data:",a),!n)throw Error("No data found");return n}catch(r){if(r instanceof a.K4||r instanceof Error)return;console.error("Unknown error:",r)}}var i=t(698),d=t(8247);function u(){let r=(0,i._)(["\n  mutation Login($identifier: String!, $password: String!) {\n    login(input: { identifier: $identifier, password: $password }) {\n      jwt\n      user {\n        documentId\n        id\n      }\n    }\n  }\n"]);return u=function(){return r},r}function l(){let r=(0,i._)(["\n  query GetVetgroupUsers($id: ID!) {\n    vetgroupUsers(filters: { user: { documentId: { eq: $id } } }) {\n      user {\n        first_name\n        last_name\n        company\n      }\n    }\n  }\n"]);return l=function(){return r},r}function m(){let r=(0,i._)(["\n  mutation ChangePassword(\n    $old_password: String!\n    $new_password: String!\n    $confirm_password: String!\n  ) {\n    changePassword(\n      currentPassword: $old_password\n      password: $new_password\n      passwordConfirmation: $confirm_password\n    ) {\n      user {\n        documentId\n      }\n    }\n  }\n"]);return m=function(){return r},r}function f(){let r=(0,i._)(["\n  query GetProducts($start: Int!, $limit: Int!) {\n    products(pagination: { start: $start, limit: $limit }) {\n      code\n      name\n      description\n      price\n      category {\n        title\n      }\n      image {\n        url\n      }\n    }\n  }\n"]);return f=function(){return r},r}function g(){let r=(0,i._)(["\n  mutation CreateOrder(\n    $order_id: String!\n    $created: DateTime!\n    $total: Float!\n    $products: String!\n    $users_permissions_user: ID!\n    $products_json: JSON!\n  ) {\n    createOrder(\n      data: {\n        order_id: $order_id\n        created: $created\n        total: $total\n        products: $products\n        users_permissions_user: $users_permissions_user\n        products_json: $products_json\n      }\n    ) {\n      order_id\n      created\n      total\n      products\n      products_json\n      users_permissions_user {\n        email\n      }\n    }\n  }\n"]);return g=function(){return r},r}function p(){let r=(0,i._)(['\n  query {\n    orders(sort: "id:desc", pagination: { limit: 1 }) {\n      order_id\n    }\n  }\n']);return p=function(){return r},r}function h(){let r=(0,i._)(["\n  query ($documentId: ID!) {\n    orders(\n      filters: { users_permissions_user: { documentId: { eq: $documentId } } }\n    ) {\n      order_id\n      total\n      created\n      products_json\n    }\n  }\n"]);return h=function(){return r},r}function y(){let r=(0,i._)(["\n  query GetCategories {\n    categories {\n      title\n    }\n  }\n"]);return y=function(){return r},r}function _(){let r=(0,i._)(["\n  query GetProductsByCat($cat: String!) {\n    products(\n      filters: { category: { title: { eq: $cat } } }\n      pagination: { limit: -1 }\n    ) {\n      code\n      name\n      description\n      price\n      image {\n        url\n      }\n    }\n  }\n"]);return _=function(){return r},r}function w(){let r=(0,i._)(["\n  query SearchProducts($filters: ProductFiltersInput) {\n    products(filters: $filters, pagination: { limit: -1 }) {\n      code\n      name\n      description\n      price\n      category {\n        title\n      }\n      image {\n        url\n      }\n    }\n  }\n"]);return w=function(){return r},r}let I=(0,d.J1)(u());(0,d.J1)(l());let S=(0,d.J1)(m()),$=(0,d.J1)(f()),v=(0,d.J1)(g()),J=(0,d.J1)(p()),C=(0,d.J1)(h()),E=(0,d.J1)(y()),P=(0,d.J1)(_()),Q=(0,d.J1)(w());var k=t(9208),G=t(6669);function q(r){G.FI.setState({isError:r})}let L=()=>new Date().toISOString().split(".")[0]+"Z",D=r=>{if(!Array.isArray(r)||0===r.length)return"<p>No items available</p>";let e="\n    <table border='1' cellpadding='5' cellspacing='0' style='border-collapse: collapse; width: 100%;'>\n      <thead>\n        <tr>\n          <th>Name</th>\n          <th>Code</th>\n          <th>Description</th>\n          <th>Image</th>\n          <th>Price</th>\n          <th>Quantity</th>\n        </tr>\n      </thead>\n      <tbody>";return r.forEach(r=>{e+="\n      <tr>\n        <td>".concat(r.name,"</td>\n        <td>").concat(r.code,"</td>\n        <td>").concat(r.description,"</td>\n        <td>").concat(r.image?"<img src='".concat(r.image,"' width='50'>"):"No Image","</td>\n        <td>").concat(r.price," AMD</td>\n        <td>").concat(r.qty,"</td>\n      </tr>")}),(e+="\n      </tbody>\n    </table>").trim()};async function U(r,e){try{let t=await c(I,{identifier:r,password:e});if(!t||t.errors){q(!0);return}let{jwt:n}=t.login;if(!n)throw Error("JWT not found in the response");document.cookie="jwt=".concat(n,"; path=/; SameSite=Strict");let{documentId:o,id:s}=t.login.user;if(!o)throw Error("documentId not found in the response");return window.location.href="/",document.cookie="document=".concat(o,"; path=/; SameSite=Strict"),document.cookie="user=".concat(s,"; path=/; SameSite=Strict"),q(!1),o}catch(r){r instanceof a.K4?console.error("GraphQL error:",r.message):r instanceof Error?console.error("JS error:",r.message):console.error("Unknown error:",r)}}async function b(r,e,t){try{let n=k.A.get("jwt");return await c(S,{old_password:r,new_password:e,confirm_password:t},{Authorization:"Bearer ".concat(n)})}catch(r){r instanceof a.K4?console.error("GraphQL error:",r.message):r instanceof Error?console.error("JS error:",r.message):console.error("Unknown error:",r)}}async function j(r,e){try{return await c($,{start:r,limit:e})||{products:[]}}catch(r){return console.error("Error fetching products:",r),{products:[]}}}async function K(){try{return await c(J,{})}catch(r){r instanceof a.K4?console.error("GraphQL error:",r.message):r instanceof Error?console.error("JS error:",r.message):console.error("Unknown error:",r)}}async function N(r,e,t){let n=await K(),o=0===n.orders.length?"1":(parseInt(n.orders[0].order_id)+1).toString(),s=L(),i=D(r);try{return await c(v,{order_id:o,created:s,total:t,products:i,users_permissions_user:e,products_json:r})}catch(r){r instanceof a.K4?console.error("GraphQL error:",r.message):r instanceof Error?console.error("JS error:",r.message):console.error("Unknown error:",r)}}async function H(r){try{let e=await c(C,{documentId:r});if(!e||!e)throw Error("Invalid response from API");return e}catch(r){r instanceof a.K4?console.error("GraphQL error:",r.message):r instanceof Error?console.error("JS error:",r.message):console.error("Unknown error:",r)}}async function O(){try{return await c(E,{})}catch(r){r instanceof a.K4?console.error("GraphQL error:",r.message):r instanceof Error?console.error("JS error:",r.message):console.error("Unknown error:",r)}}async function A(r){try{return await c(P,{cat:r})}catch(r){r instanceof a.K4?console.error("GraphQL error:",r.message):r instanceof Error?console.error("JS error:",r.message):console.error("Unknown error:",r)}}async function z(r){try{return await c(Q,{filters:function(r){let e=r.toLowerCase().split(/\s+/).filter(Boolean);return{or:[{and:e.map(r=>({name:{containsi:r}}))},{and:e.map(r=>({description:{containsi:r}}))}]}}(r)})}catch(r){r instanceof a.K4?console.error("GraphQL error:",r.message):r instanceof Error?console.error("JS error:",r.message):console.error("Unknown error:",r)}}}}]);